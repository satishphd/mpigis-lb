#include <geos/io/WKTReader.h>
#include <geos/io/WKTWriter.h>
#include <geos/geom/Geometry.h>
#include <geos/geom/Coordinate.h>

using namespace std;
using namespace geos::geom;

// compile: g++ -o parser parsing.cpp -lgeos
// run: ./parser


void printGeom(const Geometry *geom)
{
 CoordinateSequence* seq = geom->getCoordinates();
 int cords = seq->size();
 cout<< "Size of seq "<<cords<<endl;

 for(int i=0; i<cords; i++) {
  
  //Coordinate &cord = seq[i];
  //cout<<cord.x <<" "<<cord.y;
  cout<<seq->getX(i)<<" "<<seq->getY(i)<<" ";
 }

}

int main() {
 geos::io::WKTReader wktreader;
 geos::io::WKTWriter wkt;
 // geos::io::WKTWriter *wkt = new io::WKTWriter();
 //typedef std::auto_ptr<geos::geom::Geometry> GeomPtr;
 //GeomPtr geom(wktreader.read("POINT(-117 33)"));
 //Geometry *geom = wktreader.read("POINT(-117 33)");

 Geometry *geom1 = wktreader.read("GEOMETRYCOLLECTION (POLYGON ((8.6877453 50.5889002, 8.6876368 50.5889066, 8.6873752 50.5886577, 8.6870302 50.5883526, 8.6869588 50.5883036, 8.6869154 50.5882776, 8.6868697 50.5882458, 8.6866597 50.5881093, 8.6863815 50.5879466, 8.6861977 50.5878153, 8.6861715 50.5877051, 8.6860612 50.5876683, 8.6859878 50.5876526, 8.6858408 50.5875686, 8.6850137 50.5870223, 8.6857327 50.5866218, 8.6860667 50.5868703, 8.6863237 50.5869754, 8.6865495 50.5870331, 8.6872581 50.5878642, 8.6875507 50.5880765, 8.6877445 50.5882129, 8.6881499 50.5885672, 8.6885809 50.5888923, 8.6891434 50.5893269, 8.6894173 50.5895387, 8.6894721 50.5896885, 8.6896584 50.5897287, 8.6898162 50.5898052, 8.6902827 50.5901467, 8.6904035 50.5902338, 8.6905708 50.590407, 8.6908031 50.5905477, 8.690956 50.5906742, 8.6911087 50.5907436, 8.6912232 50.5908061, 8.6912163 50.5909102, 8.6911087 50.5909761, 8.6909734 50.5909866, 8.6907408 50.5909345, 8.6903313 50.5909206, 8.6900397 50.590872, 8.6896857 50.5906464, 8.6891165 50.5901744, 8.6886549 50.5897961, 8.6882303 50.5893788, 8.6880019 50.5892083, 8.6878538 50.589047, 8.6878601 50.5889513, 8.6877453 50.5889002)), POLYGON ((8.6873316 50.5909134, 8.6873975 50.5911807, 8.6873489 50.591247, 8.6873825 50.5913615, 8.6871657 50.5914266, 8.6869191 50.591481, 8.6867178 50.5915946, 8.6866697 50.5917675, 8.6869465 50.5920629, 8.687126 50.5922752, 8.6872518 50.592395, 8.6873776 50.5924341, 8.6875372 50.5925226, 8.6878902 50.5924441, 8.6882006 50.5923024, 8.6883251 50.5921908, 8.6884482 50.5920054, 8.6885256 50.5918991, 8.6885815 50.591817, 8.6886483 50.5917924, 8.6887689 50.5917362, 8.6887616 50.5916528, 8.6887961 50.5915726, 8.6888861 50.591513, 8.6889398 50.5915154, 8.6889992 50.5915276, 8.689026 50.5915835, 8.6889302 50.5916066, 8.6889091 50.5916383, 8.68898 50.5916322, 8.689026 50.5916018, 8.689118 50.591682, 8.6891585 50.591693, 8.6892521 50.5916237, 8.689185 50.5916018, 8.6891793 50.5915823, 8.6892444 50.5915215, 8.6893364 50.591496, 8.6894379 50.5915057, 8.6895567 50.5915616, 8.6896238 50.591485, 8.6897953 50.591533, 8.6898018 50.5916112, 8.6899318 50.5916593, 8.6900782 50.5916215, 8.6905012 50.5918998, 8.690753 50.5921006, 8.6908963 50.5922593, 8.6913471 50.5924573, 8.6915277 50.592669, 8.6917284 50.5927785, 8.6917661 50.5928479, 8.6917016 50.5929081, 8.6912406 50.5929469, 8.690891 50.5929648, 8.6904759 50.5929158, 8.6901529 50.592791, 8.6897015 50.5927154, 8.689476 50.5926005, 8.6892138 50.592466, 8.6890306 50.5924506, 8.688932 50.5924746, 8.6888585 50.5925172, 8.6887608 50.5926409, 8.6886834 50.5929572, 8.6885852 50.5929408, 8.6885202 50.593001, 8.6883387 50.5931231, 8.6882032 50.5931454, 8.6881018 50.5930882, 8.6879748 50.5931079, 8.6878562 50.5931411, 8.6877517 50.59315, 8.6875969 50.5931755, 8.6875305 50.5931908, 8.6874682 50.5932189, 8.6874018 50.5932011, 8.6873476 50.5931985, 8.6870678 50.5932416, 8.6867699 50.5932404, 8.6864692 50.5932038, 8.6865723 50.5930611, 8.6861132 50.5929381, 8.6861187 50.5927706, 8.6859408 50.5924888, 8.6858576 50.5921409, 8.6860207 50.5918903, 8.6862081 50.5916214, 8.6866545 50.5913567, 8.6868016 50.5912869, 8.6868881 50.5913202, 8.6870222 50.5912023, 8.6868984 50.5911584, 8.6870043 50.5910226, 8.6871335 50.5908321, 8.6874492 50.5906078, 8.6874281 50.590517, 8.6874221 50.5903999, 8.6876767 50.5903413, 8.6880876 50.5903076, 8.6881798 50.5902334, 8.6880209 50.589869, 8.6879893 50.58978, 8.6880607 50.5897619, 8.6883234 50.5899775, 8.6884851 50.5901796, 8.6887007 50.5903345, 8.6887676 50.5904815, 8.6887901 50.5905583, 8.6888022 50.5906633, 8.6887266 50.5907175, 8.688401 50.5907404, 8.6880093 50.5907111, 8.6876084 50.5906831, 8.6874813 50.5907568, 8.6873413 50.5908305, 8.6873316 50.5909134)))");
 int pCount = geom1->getNumGeometries();
 cout<< "Number of polygons "<<pCount<<endl;

 const Geometry *geom = geom1->getGeometryN(0);
 printGeom(geom);
 
 cout<<endl;
  
 geom = geom1->getGeometryN(1);
 printGeom(geom);

 cout<<endl;
  
 geom = wktreader.read("POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))"); 
// geom = wktreader.read("POLYGON((121.4416947 25.1339076, 121.442911 25.1339513, 121.4429928 25.1339391, 121.4432593 25.133807, 121.4433053 25.1337964, 121.4433919 25.1338274, 121.4434691 25.1338634, 121.4436344 25.133747, 121.4435767 25.1336524, 121.4434815 25.1336848, 121.4433864 25.1336637, 121.4433926 25.1336227, 121.4434659 25.1336128, 121.4435377 25.1334646, 121.4435798 25.1332965, 121.4437435 25.1331017, 121.4439946 25.133072, 121.4441709 25.1330735, 121.4444267 25.1329196, 121.4448259 25.132921, 121.4448649 25.1330509, 121.4449569 25.1332471, 121.4449647 25.1332965, 121.4451207 25.1332951, 121.4451877 25.1333318, 121.4451628 25.1334208, 121.4451441 25.1334561, 121.4454326 25.1334236, 121.445548 25.1336029, 121.4457367 25.1337597, 121.4460455 25.1336764, 121.4460892 25.1336269, 121.4459566 25.1334985, 121.445913 25.133425, 121.4460125 25.1332457, 121.4459345 25.1331582, 121.4457786 25.1331469, 121.4455758 25.132969, 121.4453294 25.1326273, 121.4464149 25.132472, 121.446811 25.132551, 121.4468485 25.1325962, 121.4466364 25.1327148, 121.4464211 25.1328447, 121.4462059 25.1331215, 121.4462621 25.1332147, 121.4465927 25.133017, 121.4468859 25.1330367, 121.4468734 25.1332062, 121.4464779 25.1333252, 121.4463103 25.133467, 121.4463324 25.1338065, 121.4466676 25.1338544, 121.447069 25.13411, 121.4470624 25.1341579, 121.4469389 25.1342837, 121.4467837 25.1344557, 121.446765 25.1345025, 121.4468851 25.1346197, 121.447119 25.13484, 121.4470176 25.1349275, 121.4470597 25.1349812, 121.4467915 25.1351196, 121.4468086 25.1353031, 121.4466714 25.1353342, 121.4465513 25.135313, 121.4464858 25.1352989, 121.4464796 25.1353652, 121.446138 25.1352071, 121.4460865 25.1353215, 121.4462877 25.1353441, 121.4463735 25.1354415, 121.4465123 25.1354443, 121.4469396 25.135577, 121.4469085 25.1356462, 121.4467556 25.135769, 121.4465196 25.1358968, 121.4463233 25.1360546, 121.4461755 25.1360526, 121.4459748 25.1360326, 121.4459042 25.1361364, 121.4456704 25.1361185, 121.445655 25.1362083, 121.4460917 25.1363661, 121.4462219 25.1365158, 121.4465417 25.1365697, 121.4465218 25.1367435, 121.4461667 25.1367075, 121.445569 25.1366037, 121.4454609 25.1365418, 121.4453992 25.1365877, 121.4456131 25.1368233, 121.4460454 25.1370629, 121.4461954 25.1372966, 121.4468549 25.1375362, 121.4473136 25.1377119, 121.4473952 25.1378816, 121.4473269 25.1379934, 121.4469357 25.137954, 121.4463992 25.1379187, 121.4463477 25.1380373, 121.4462089 25.1380415, 121.4462978 25.1381418, 121.4464803 25.1381149, 121.4464675 25.1383929, 121.4465298 25.1385144, 121.4467669 25.1386019, 121.4473502 25.1384099, 121.4474251 25.1382941, 121.4475623 25.1383365, 121.4478306 25.1384664, 121.447843 25.1385906, 121.4477339 25.1386245, 121.4472691 25.1386753, 121.4472816 25.13876, 121.4471662 25.1388137, 121.4468605 25.1387741, 121.4466609 25.1388447, 121.4465512 25.1387722, 121.4463748 25.1387303, 121.4460373 25.1386983, 121.4458432 25.1387442, 121.4455763 25.1388581, 121.4454837 25.1389998, 121.4457307 25.1392494, 121.4457572 25.1393552, 121.4454572 25.1394571, 121.4451484 25.1392654, 121.4450558 25.1391935, 121.4448948 25.1390557, 121.444661 25.1390058, 121.4444559 25.1389419, 121.4443963 25.1388141, 121.4440324 25.1388769, 121.4438427 25.1389507, 121.4435957 25.1390825, 121.4433332 25.1391544, 121.4432604 25.1390346, 121.4428546 25.1388908, 121.4427509 25.1387131, 121.4427686 25.1386073, 121.4429715 25.1385853, 121.44302 25.1384655, 121.4429781 25.1383038, 121.4431523 25.1382718, 121.4431303 25.1381361, 121.4429428 25.1380802, 121.4427994 25.1378465, 121.4426892 25.1378006, 121.4425193 25.1376209, 121.4422017 25.1377048, 121.4421598 25.1378206, 121.4423076 25.1378545, 121.4423076 25.1379344, 121.442065 25.1379644, 121.4420054 25.1380582, 121.4420672 25.1380921, 121.4418841 25.1381061, 121.4417275 25.1379683, 121.4417937 25.1378406, 121.4417672 25.1377707, 121.4419988 25.1376928, 121.4420385 25.137565, 121.4421642 25.1374712, 121.4423164 25.1374532, 121.4423169 25.137182, 121.4426195 25.1371538, 121.4428029 25.136944, 121.4426441 25.1367264, 121.442547 25.1366165, 121.4426375 25.1365527, 121.4428624 25.1364289, 121.4430345 25.1362152, 121.4429352 25.136061, 121.4426639 25.136031, 121.4424985 25.1358753, 121.4421897 25.1359811, 121.4418302 25.1360729, 121.4420331 25.1363565, 121.4420596 25.1364364, 121.4419978 25.1365022, 121.4419074 25.136642, 121.4417618 25.13665, 121.4415192 25.1365302, 121.4416868 25.1361728, 121.4417133 25.1359212, 121.4414023 25.1359971, 121.4411465 25.136033, 121.4409215 25.1359711, 121.4407539 25.1359511, 121.4405774 25.1360969, 121.4403811 25.1362147, 121.4402267 25.1362147, 121.43994 25.1362027, 121.4397106 25.1361588, 121.4398076 25.136025, 121.4393886 25.136055, 121.4392893 25.1359092, 121.4393952 25.1358154, 121.4395275 25.1356456, 121.4390621 25.1356377, 121.4385945 25.1358573, 121.4384379 25.1359811, 121.4383123 25.1361174, 121.4384667 25.1362612, 121.4385241 25.1362831, 121.4386101 25.1365867, 121.4386388 25.1368323, 121.4386013 25.1369081, 121.4384314 25.1369201, 121.4382969 25.1368702, 121.4382418 25.1368203, 121.4382792 25.1366406, 121.4382748 25.1364489, 121.4381006 25.1360915, 121.4380454 25.1359477, 121.4375801 25.1358738, 121.4374654 25.1358738, 121.4372139 25.1358439, 121.4370948 25.1356182, 121.4371191 25.1354765, 121.436936 25.1355583, 121.4369118 25.1356781, 121.4367904 25.1361234, 121.4369096 25.1363171, 121.4371698 25.1366865, 121.4374301 25.1371937, 121.4375139 25.1373215, 121.4375161 25.1374832, 121.4373794 25.1374992, 121.4368831 25.1371238, 121.4366316 25.1369441, 121.4361817 25.1368622, 121.4359391 25.1366466, 121.4356943 25.1363271, 121.4356766 25.1360096, 121.4356501 25.1355304, 121.4354935 25.1353127, 121.4354671 25.1351031, 121.4355729 25.1348195, 121.4356171 25.1346119, 121.4357163 25.1342844, 121.4357604 25.1341366, 121.4359104 25.1341007, 121.4358531 25.1338291, 121.4360317 25.1337492, 121.436142 25.1336574, 121.4361486 25.1335296, 121.436711 25.1332381, 121.4372492 25.1329925, 121.4376528 25.133278, 121.4377675 25.1333938, 121.4377433 25.1335056, 121.4372911 25.1339569, 121.4372779 25.1342884, 121.4368169 25.1348674, 121.4368103 25.1349573, 121.4373948 25.1351829, 121.4374985 25.135171, 121.4375051 25.1349633, 121.4376176 25.1346378, 121.4376176 25.1345729, 121.4376894 25.1343907, 121.4377323 25.1343942, 121.4378337 25.1344701, 121.4380498 25.1343518, 121.4380763 25.134202, 121.4381888 25.1340203, 121.4382203 25.1339494, 121.4382873 25.1338979, 121.4383903 25.1338654, 121.4383925 25.1337603, 121.438461 25.1335581, 121.4385956 25.1334443, 121.4387632 25.1334256, 121.4388942 25.1333282, 121.439058 25.1332025, 121.4389488 25.133074, 121.4388708 25.1330698, 121.4387258 25.1328975, 121.4387885 25.1327657, 121.4389252 25.132562, 121.4390796 25.1324282, 121.4392164 25.1323763, 121.4393399 25.1323364, 121.439523 25.1321287, 121.4395362 25.1320209, 121.4397082 25.1318352, 121.4401604 25.1318272, 121.4401538 25.131941, 121.440231 25.1320368, 121.4402398 25.1321347, 121.4399773 25.1322445, 121.4399663 25.1323224, 121.4400611 25.132576, 121.4400655 25.1326858, 121.4399023 25.1328855, 121.4400325 25.1330472, 121.440392 25.133167, 121.4405464 25.133187, 121.4405728 25.1329094, 121.440853 25.1328156, 121.4408507 25.1327118, 121.4409588 25.1326998, 121.4410779 25.1328396, 121.4411176 25.1328276, 121.4410757 25.132572, 121.441122 25.1325041, 121.4412588 25.1324861, 121.4413051 25.1325181, 121.4413073 25.1327078, 121.4413139 25.1328076, 121.4414727 25.1327237, 121.4415654 25.1324861, 121.4417859 25.1323463, 121.4418565 25.1323523, 121.4421035 25.132542, 121.4421741 25.1326978, 121.4422778 25.1330073, 121.442344 25.1332369, 121.4423859 25.1333507, 121.4422668 25.1335245, 121.4420241 25.1335704, 121.4417027 25.1336936, 121.4416705 25.1338514, 121.4416947 25.1339076 ))" );
 string tmp=wkt.write(geom);
 cout<<tmp<<endl;
 return 0;
}
